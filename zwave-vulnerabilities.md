---
# Z-wave Vulnerabilities


| Vulnerability         | Description                                                                                                      | Scenario                                                                                                               | Attack Steps                                                                                                                                    |
|-----------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| Insecure Inclusion    | Z-Wave networks allow new devices to be included without authentication.                                           | Attacker sets up RFcat and transmits spoofed inclusion packets during inclusion mode to add their device.            | - Capture inclusion packets using SDR. - Analyze packets and craft spoofed inclusion packet. - Transmit spoofed packet to add rogue node.        |
| Insecure Transmission | Z-Wave uses weak encryption (AES-128) and some devices have no encryption.                                         | Attacker uses RTL-SDR dongle to intercept encrypted Z-Wave signals. They capture the encryption key leaked in one frame and decrypt all communications. | - Set up RTL-SDR dongle and Kali Linux for packet sniffing. - Decrypt captured traffic using extracted AES encryption key.                        |
| Replay Attacks        | Unencrypted or broken encryption Z-Wave commands can be captured and retransmitted to control devices.           | Attacker records command sending "unlock" to a smart lock node. They replay it later to unlock the door without authorization. | - Capture command packets. - Replay captured packets to perform unauthorized actions.                                                           |
| Weak Keys             | Some Z-Wave devices have hardcoded encryption keys that are extracted and used to decrypt communications.         | Attacker extracts hardcoded AES key from a smart bulb's firmware. They use it to decrypt Z-Wave traffic and replay commands. | - Extract hardcoded AES keys from device firmware. - Use keys to decrypt Z-Wave traffic and replay commands.                                     |
| Forced Inclusion      | Tools like BANANA can jam the controller and force nodes into inclusion mode, allowing capture and replay attacks. | Attacker uses BANANA device to jam the controller. Nodes enter inclusion mode. Attacker replays captured inclusion packets to add their device. | - Continuously jam Z-Wave controller. - Capture inclusion packets. - Replay packets to add malicious nodes.                                      |
| Brute Force Attacks   | The 24-bit Network PIN can be brute forced as the key space is relatively small.                                   | Attacker brute forces weak 24-bit network PIN to gain access to Z-Wave network and control devices.                   | - Capture network key exchange frame during inclusion. - Brute force 24-bit PIN. - Gain access to Z-Wave network.                                |
| De-encapsulation Attacks | Z-Wave uses encapsulated frames which can be decapsulated into raw Z-Wave commands and replayed if encryption is broken. | Attacker strips the Z-Wave routing encapsulation to obtain raw frames. They replay commands after decrypting payload.  | - Analyze captured packets to understand encapsulation. - Write code to strip encapsulation and decrypt payload. - Replay commands.               |
| Firmware Downgrade    | Some devices allow firmware downgrades to older vulnerable versions without authentication.                        | Attacker downgrades smart lock firmware via unauthenticated OTA update. Older firmware has auth bypass bug they exploit. | - Reverse engineer device OTA protocol. - Craft fake firmware image. - Exploit vulnerabilities in older firmware.                              |
| Command Injection     | Sending malformed input to handler functions could cause command injection and execution of arbitrary code.       | Attacker sends malformed packet that injects OS commands into smart bulb's command handler. Executes code on the device. | - Fuzz packet parameters. - Identify vulnerable input parameters. - Craft input strings with OS commands. - Execute arbitrary code.         |
| Weaknesses in Protocol | Design weaknesses like lack of source authentication and integrity checking enable attacks like signal replay.    | Attacker replays captured "on" command due to lack of source authentication in Z-Wave protocol.                       | - Capture and analyze packets. - Replay commands without proper source validation.                                                               |

